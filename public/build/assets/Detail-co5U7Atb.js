var V=Object.defineProperty;var N=(c,r,n)=>r in c?V(c,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):c[r]=n;var b=(c,r,n)=>(N(c,typeof r!="symbol"?r+"":r,n),n);import{j as g}from"./AboutHeader-CpM0iYLI.js";import{r as a}from"./index-B80Lgev0.js";import{m as S}from"./main-Br9xqDfn.js";import{B as A}from"./Results-B-D6O2Fz.js";import{M as L,u as P,P as T,a as F,b as O,L as $,m as B}from"./proxy-BI9mV89-.js";import{c as D}from"./createLucideIcon-Cx5eUsrb.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";class J extends A{constructor(){super(...arguments);b(this,"path","items");b(this,"verifyStock",async n=>{try{const{status:s,result:l}=await S.Fetch(`/api/${this.path}/verify-stock`,{method:"POST",body:JSON.stringify(n)});if(!s)throw new Error((l==null?void 0:l.message)??"OcurriÃ³ un error al consultar el stock de los productos");return l.data??[]}catch{return[]}});b(this,"getDestacados",async()=>{try{const{status:n,result:s}=await S.Fetch(`/api/${this.path}/get-destacados`,{method:"GET"});if(!n)throw new Error((s==null?void 0:s.message)??"OcurriÃ³ un error al consultar el stock de los productos");return s.data??[]}catch{return[]}})}}class _ extends a.Component{getSnapshotBeforeUpdate(r){const n=this.props.childRef.current;if(n&&r.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=n.offsetHeight||0,s.width=n.offsetWidth||0,s.top=n.offsetTop,s.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function G({children:c,isPresent:r}){const n=a.useId(),s=a.useRef(null),l=a.useRef({width:0,height:0,top:0,left:0}),{nonce:v}=a.useContext(L);return a.useInsertionEffect(()=>{const{width:C,height:f,top:q,left:m}=l.current;if(r||!s.current||!C||!f)return;s.current.dataset.motionPopId=n;const p=document.createElement("style");return v&&(p.nonce=v),document.head.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${C}px !important;
            height: ${f}px !important;
            top: ${q}px !important;
            left: ${m}px !important;
          }
        `),()=>{document.head.removeChild(p)}},[r]),g.jsx(_,{isPresent:r,childRef:s,sizeRef:l,children:a.cloneElement(c,{ref:s})})}const K=({children:c,initial:r,isPresent:n,onExitComplete:s,custom:l,presenceAffectsLayout:v,mode:C})=>{const f=P(U),q=a.useId(),m=a.useCallback(E=>{f.set(E,!0);for(const t of f.values())if(!t)return;s&&s()},[f,s]),p=a.useMemo(()=>({id:q,initial:r,isPresent:n,custom:l,onExitComplete:m,register:E=>(f.set(E,!1),()=>f.delete(E))}),v?[Math.random(),m]:[n,m]);return a.useMemo(()=>{f.forEach((E,t)=>f.set(t,!1))},[n]),a.useEffect(()=>{!n&&!f.size&&s&&s()},[n]),C==="popLayout"&&(c=g.jsx(G,{isPresent:n,children:c})),g.jsx(T.Provider,{value:p,children:c})};function U(){return new Map}const j=c=>c.key||"";function k(c){const r=[];return a.Children.forEach(c,n=>{a.isValidElement(n)&&r.push(n)}),r}const X=({children:c,custom:r,initial:n=!0,onExitComplete:s,presenceAffectsLayout:l=!0,mode:v="sync",propagate:C=!1})=>{const[f,q]=F(C),m=a.useMemo(()=>k(c),[c]),p=C&&!f?[]:m.map(j),E=a.useRef(!0),t=a.useRef(m),i=P(()=>new Map),[x,e]=a.useState(m),[o,d]=a.useState(m);O(()=>{E.current=!1,t.current=m;for(let w=0;w<o.length;w++){const u=j(o[w]);p.includes(u)?i.delete(u):i.get(u)!==!0&&i.set(u,!1)}},[o,p.length,p.join("-")]);const y=[];if(m!==x){let w=[...m];for(let u=0;u<o.length;u++){const z=o[u],I=j(z);p.includes(I)||(w.splice(u,0,z),y.push(z))}v==="wait"&&y.length&&(w=y),d(k(w)),e(m);return}const{forceRender:h}=a.useContext($);return g.jsx(g.Fragment,{children:o.map(w=>{const u=j(w),z=C&&!f?!1:m===o||p.includes(u),I=()=>{if(i.has(u))i.set(u,!0);else return;let R=!0;i.forEach(M=>{M||(R=!1)}),R&&(h==null||h(),d(t.current),C&&(q==null||q()),s&&s())};return g.jsx(K,{isPresent:z,initial:!E.current||n?void 0:!1,custom:z?void 0:r,presenceAffectsLayout:l,mode:v,onExitComplete:z?void 0:I,children:w},u)})})};/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=D("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),W=({message:c,actionLabel:r,onAction:n,duration:s=5e3,onClose:l})=>{const[v,C]=a.useState(!0);a.useEffect(()=>{const q=setTimeout(()=>C(!1),s);return()=>clearTimeout(q)},[s]);const f=()=>{C(!1),l&&l()};return g.jsx(X,{children:v&&g.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.3},className:`fixed md:bottom-10 md:left-10 bottom-4 left-4 right-4 
                bg-[#5339B1] text-white px-4 py-3 md:px-6 md:py-5 rounded-lg 
                md:rounded-xl shadow-xl flex items-center justify-between 
                space-x-2 md:space-x-4 z-[9999] max-w-[90vw] lg:w-max mx-auto`,children:[g.jsx("span",{className:"flex-grow text-sm md:text-base max-w-[200px] md:max-w-none truncate",children:c}),g.jsxs("div",{className:"flex items-center space-x-2 md:space-x-4 flex-shrink-0",children:[r&&g.jsx("a",{href:"/checkout",className:`bg-[#FF9900] text-white px-3 py-2 
                            md:px-4 md:py-3 text-sm md:text-base rounded-lg
                            md:rounded-xl shadow hover:bg-[#FFAA33] 
                            transition-colors whitespace-nowrap`,children:r}),g.jsx("button",{onClick:f,className:`bg-red-600 hover:bg-red-700 p-2 
                        md:p-3 text-white rounded-lg md:rounded-xl 
                        transition-colors`,children:g.jsx(H,{size:18,className:"md:w-5 md:h-5 w-4 h-4"})})]})]})})},Q=a.createContext(),Y=new J,ae=({children:c})=>{const[r,n]=a.useState(()=>{const t=localStorage.getItem("carrito");return t?JSON.parse(t):[]}),[s,l]=a.useState(null);a.useRef(null);const v=async()=>{try{if(r.length===0)return;Y.verifyStock(r.map(t=>t.id)).then(t=>{const i=r.map(x=>{const e=t.find(o=>o.id===x.id);return e?{...x,price:e.price,final_price:e.final_price,discount:e.discount,name:e.name}:x});n(i)})}catch(t){console.error("Error al actualizar precios:",t)}};a.useEffect(()=>{v()},[]),a.useEffect(()=>{localStorage.setItem("carrito",JSON.stringify(r))},[r]),a.useEffect(()=>{if(r.length>0){const t=setTimeout(()=>{l({message:"Â¡No olvides completar tu compra! ðŸ˜‰",actionLabel:"Ver carrito",onAction:()=>console.log("Ir al carrito"),duration:5e3});const i=setInterval(()=>{l({message:"Â¡No olvides completar tu compra! ðŸ˜‰",actionLabel:"Ver carrito",onAction:()=>console.log("Ir al carrito"),duration:5e3})},3e4);return()=>clearInterval(i)},6e4);return()=>clearTimeout(t)}else l(null)},[r]);const C=t=>{n(i=>{var d;if(!(t.sizes&&t.sizes.length>0||t.colors&&t.colors.length>0))return i.find(h=>h.id===t.id)?i.map(h=>h.id===t.id?{...h,quantity:h.quantity+t.quantity}:h):[...i,{...t,variations:[],quantity:t.quantity}];const e={color:t.selectedColor||null,size:t.selectedSize||null,quantity:t.quantity},o=i.findIndex(y=>y.id===t.id);if(o>=0){const y=[...i],h=y[o],w=((d=h.variations)==null?void 0:d.findIndex(u=>u.color===e.color&&u.size===e.size))??-1;return w>=0?y[o]={...h,variations:h.variations.map((u,z)=>z===w?{...u,quantity:u.quantity+e.quantity}:u)}:y[o]={...h,variations:[...h.variations,e]},y}else return[...i,{...t,variations:[e],quantity:t.quantity}]}),l({message:"Se ha agregado el artÃ­culo al carrito",actionLabel:"Ver carrito",duration:5e3})},f=t=>{n(i=>i.filter(x=>x.id!==t)),l(null)},q=()=>{n([]),l(null)},m=(t,i=null)=>{n(x=>x.map(e=>e.id===t&&(!e.variations||e.variations.length===0)?{...e,quantity:e.quantity+1}:e.id===t&&e.variations&&e.variations.length>0?i?{...e,variations:e.variations.map(o=>o.color===i.color&&o.size===i.size?{...o,quantity:o.quantity+1}:o)}:{...e,variations:e.variations.map((o,d)=>d===0?{...o,quantity:o.quantity+1}:o)}:e))},p=(t,i=null)=>{n(x=>x.map(e=>{if(e.id===t&&(!e.variations||e.variations.length===0))return{...e,quantity:Math.max(1,e.quantity-1)};if(e.id===t&&e.variations&&e.variations.length>0){if(!i){const d=e.variations.map((y,h)=>h===0?{...y,quantity:Math.max(1,y.quantity-1)}:y);return{...e,variations:d}}const o=e.variations.map(d=>d.color===i.color&&d.size===i.size?{...d,quantity:Math.max(1,d.quantity-1)}:d);return{...e,variations:o}}return e}))},E=(t,i=null)=>{n(x=>i?x.map(e=>{if(e.id===t&&e.variations){const o=e.variations.filter(d=>!(d.color===i.color&&d.size===i.size&&d.quantity===0));return o.length===0?null:{...e,variations:o}}return e}).filter(Boolean):x.filter(e=>!(e.id===t&&e.quantity===0)))};return g.jsxs(Q.Provider,{value:{carrito:r,agregarAlCarrito:C,eliminarProducto:f,vaciarCarrito:q,actualizarPrecios:v,decrementarCantidad:p,incrementarCantidad:m,eliminarSiCero:E},children:[c,s&&g.jsx(W,{...s,onClose:()=>l(null)})]})};export{ae as C,Q as a};
